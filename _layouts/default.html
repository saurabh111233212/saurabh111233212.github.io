<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>{{ page.title | default: site.title }}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
    <meta name="author" content="Saurabh Shah">
    <meta name="keywords" content="Saurabh Shah, AI research, machine learning, NLP, OLMo, Tülu, Allen Institute, Ai2, language models, artificial intelligence">
    <link rel="canonical" href="{{ page.url | absolute_url }}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ page.url | absolute_url }}">
    <meta property="og:title" content="{{ page.title | default: site.title }}">
    <meta property="og:description" content="{{ page.description | default: site.description }}">
    <meta property="og:image" content="{{ '/assets/headshot.png' | absolute_url }}">
    <meta property="og:site_name" content="Saurabh Shah">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ page.url | absolute_url }}">
    <meta property="twitter:title" content="{{ page.title | default: site.title }}">
    <meta property="twitter:description" content="{{ page.description | default: site.description }}">
    <meta property="twitter:image" content="{{ '/assets/headshot.png' | absolute_url }}">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Saurabh Shah",
      "jobTitle": "Research Engineer",
      "worksFor": {
        "@type": "Organization",
        "name": "Allen Institute for Artificial Intelligence"
      },
      "url": "{{ site.url }}",
      "image": "{{ '/assets/headshot.png' | absolute_url }}",
      "sameAs": [
        "https://github.com/saurabh111233212",
        "https://scholar.google.com/citations?hl=en&user=iB_qEXkAAAAJ",
        "https://www.linkedin.com/in/saurabh-shah-90063a18a/",
        "https://learnycurve.substack.com/"
      ],
      "alumniOf": {
        "@type": "Organization",
        "name": "University of Pennsylvania"
      },
      "knowsAbout": [
        "Machine Learning",
        "Natural Language Processing", 
        "Artificial Intelligence",
        "Language Models",
        "Deep Learning"
      ]
    }
    </script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="{{ '/assets/favicon.ico' | relative_url }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/favicon-32x32.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/favicon-16x16.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/apple-touch-icon.png' | relative_url }}">
    
    <!-- Jekyll SEO Tag -->
    {% seo %}
</head>
<body>
    <!-- Skip navigation link for keyboard users -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <a href="/" class="nav-brand">Saurabh Shah</a>
            <div class="nav-menu">
                {% if page.url == "/" %}
                <a href="#home" class="nav-link">Home</a>
                <a href="#about" class="nav-link">About</a>
                <a href="#research" class="nav-link">Research</a>
                <a href="#projects" class="nav-link">Projects</a>
                <a href="#fun" class="nav-link">Fun</a>
                {% else %}
                <a href="/" class="nav-link">Home</a>
                {% endif %}
                <a href="/resume/" class="nav-link nav-resume">Resume</a>
                <button id="fun-toggle" class="fun-toggle" aria-label="Toggle fun effects">
                    <span class="fun-toggle-text">I'm feelin' dangerous :)</span>
                </button>
                <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <svg class="sun-icon" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                        <path d="M12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18M12,2L14.39,5.42C13.65,5.15 12.84,5 12,5C11.16,5 10.35,5.15 9.61,5.42L12,2M3.34,7L7.5,6.65C6.9,7.16 6.36,7.78 5.94,8.5C5.5,9.24 5.25,10 5.11,10.79L3.34,7M3.36,17L5.12,13.23C5.26,14 5.53,14.78 5.95,15.5C6.37,16.24 6.91,16.86 7.5,17.37L3.36,17M20.65,7L18.88,10.79C18.74,10 18.47,9.23 18.05,8.5C17.63,7.78 17.1,7.15 16.5,6.64L20.65,7M20.64,17L16.5,17.36C17.09,16.85 17.62,16.22 18.04,15.5C18.46,14.77 18.73,14 18.87,13.21L20.64,17M12,22L9.59,18.56C10.33,18.83 11.14,19 12,19C12.82,19 13.63,18.83 14.37,18.56L12,22Z"/>
                    </svg>
                    <svg class="moon-icon" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                        <path d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.4 6.35,17.41C9.37,20.43 14,20.54 17.33,17.97Z"/>
                    </svg>
                </button>
            </div>
            <div class="nav-toggle" id="mobile-menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <main class="container" id="main-content">
        {{ content }}
    </main>
    
    <footer class="footer">
        <div class="container">
            <p>© 2025 Saurabh Shah. Research Engineer at Allen Institute for AI. what's up footer enjoyers. this website is proudly 100% vibe-coded</p>
        </div>
    </footer>

    <!-- Initialize theme immediately to prevent flash -->
    <script>
        // Initialize theme IMMEDIATELY to prevent flash of wrong theme
        (function() {
            function getInitialTheme() {
                try {
                    const savedTheme = localStorage.getItem('theme');
                    if (savedTheme) {
                        return savedTheme;
                    }
                    // Check system preference
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        return 'dark';
                    }
                    return 'light';
                } catch (e) {
                    return 'light';
                }
            }
            
            const theme = getInitialTheme();
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        })();
    </script>

    <!-- Main functionality script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Theme management
            const themeToggle = document.getElementById('theme-toggle');
            const html = document.documentElement;
            
            if (!themeToggle) {
                console.warn('Theme toggle button not found');
                return;
            }
            
            // Get initial theme - check localStorage first, then system preference
            function getInitialTheme() {
                try {
                    const savedTheme = localStorage.getItem('theme');
                    if (savedTheme) {
                        return savedTheme;
                    }
                    // Check system preference
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        return 'dark';
                    }
                    return 'light';
                } catch (e) {
                    return 'light';
                }
            }
            
            // Apply theme
            function applyTheme(theme) {
                try {
                    if (theme === 'dark') {
                        html.setAttribute('data-theme', 'dark');
                    } else {
                        html.removeAttribute('data-theme');
                    }
                    localStorage.setItem('theme', theme);
                } catch (e) {
                    console.warn('Could not save theme preference:', e);
                }
            }
            
            // Initialize theme (redundant check for safety)
            const currentTheme = getInitialTheme();
            applyTheme(currentTheme);
            
            // Theme toggle functionality
            themeToggle.addEventListener('click', function() {
                const currentTheme = html.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                applyTheme(newTheme);
            });
            
            // Listen for system theme changes
            if (window.matchMedia) {
                try {
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                        // Only auto-switch if user hasn't manually set a preference
                        if (!localStorage.getItem('theme')) {
                            applyTheme(e.matches ? 'dark' : 'light');
                        }
                    });
                } catch (e) {
                    console.warn('Could not set up system theme listener:', e);
                }
            }

            // Fun effects toggle
            const funToggle = document.getElementById('fun-toggle');
            const funToggleText = funToggle ? funToggle.querySelector('.fun-toggle-text') : null;

            if (funToggle && funToggleText) {
                // Get saved preference (default to off)
                function getFunEffectsEnabled() {
                    try {
                        const saved = localStorage.getItem('funEffects');
                        return saved === 'true';
                    } catch (e) {
                        return false;
                    }
                }

                // Apply fun effects state
                function applyFunEffects(enabled) {
                    try {
                        if (enabled) {
                            window.funEffects.start();
                            funToggle.classList.add('active');
                            funToggleText.textContent = "I'm not feelin' dangerous :(";
                        } else {
                            window.funEffects.stop();
                            funToggle.classList.remove('active');
                            funToggleText.textContent = "I'm feelin' dangerous :)";
                        }
                        localStorage.setItem('funEffects', enabled);
                    } catch (e) {
                        console.warn('Could not save fun effects preference:', e);
                    }
                }

                // Initialize (default to off)
                const funEnabled = getFunEffectsEnabled();
                applyFunEffects(funEnabled);

                // Toggle on click
                funToggle.addEventListener('click', function() {
                    const currentlyEnabled = window.funEffects.isActive();
                    applyFunEffects(!currentlyEnabled);
                });
            }

            // Smooth scrolling for navigation links
            document.querySelectorAll('.nav-link[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        const headerOffset = 80;
                        const elementPosition = target.offsetTop;
                        const offsetPosition = elementPosition - headerOffset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Mobile menu toggle
            const mobileMenu = document.getElementById('mobile-menu');
            const navMenu = document.querySelector('.nav-menu');

            if (mobileMenu && navMenu) {
                mobileMenu.addEventListener('click', function() {
                    mobileMenu.classList.toggle('is-active');
                    navMenu.classList.toggle('active');
                });

                // Close mobile menu when clicking on a link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenu.classList.remove('is-active');
                        navMenu.classList.remove('active');
                    });
                });
            }

            document.addEventListener('keydown', function(event) {
                if (event.key.toLowerCase() === 'd') {
                    if (event.target.tagName !== 'INPUT' && event.target.tagName !== 'TEXTAREA' && !event.target.isContentEditable) {
                        window.location.href = 'https://davidheineman.com';
                    }
                }

                // Katamari Damacy
                if (event.key.toLowerCase() === 's') {
                    if (event.target.tagName !== 'INPUT' && event.target.tagName !== 'TEXTAREA' && !event.target.isContentEditable) {
                        if (window.katamariLoaded) return;

                        var jqueryScript = document.createElement('script');
                        jqueryScript.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js';
                        jqueryScript.onload = function() {
                            var katamariScript = document.createElement('script');
                            katamariScript.src = '{{ "/assets/js/kh.js" | relative_url }}';
                            katamariScript.onload = function() {
                                window.katamariLoaded = true;
                            };
                            document.body.appendChild(katamariScript);
                        };
                        document.body.appendChild(jqueryScript);
                    }
                }
            });
        });
    </script>

    <!-- Fun effects: floating animals and cursor trail -->
    <script src="{{ '/assets/js/fun-effects.js' | relative_url }}"></script>
</body>
</html> 